{% extends 'base.html' %}
{% load static %}

{% block title %}Reports | RadiologyIS{% endblock %}

{% block extra_styles %}
    <link rel="stylesheet" href="{% static 'reports.css' %}">
{% endblock %}

{% block content %}

<!-- Reports Section -->
<div id="reports" class="section active">
    <h1>üìã Radiology Reports</h1>

    <div class="report-editor" id="reportEditor">
        <!-- Uploaded Studies Table -->
        <div class="studies-table-container">
            <h3>
                <span>üî¨</span>
                <span>Uploaded Studies - DICOM Available</span>
            </h3>
                
            <table class="studies-table">
                <thead>
                    <tr>
                        <th>Patient Information</th>
                        <th>Procedure Type</th>
                        <th>Upload Date & Time</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for schedule in schedules %}
                        {% with study=schedule.studies.all|first %}
                            {% if study %}
                                <tr>
                                    <td>
                                        <div class="patient-id">{{ schedule.patient.patient_id }}</div>
                                        <div class="patient-name">
                                            {{ schedule.patient.first_name }} {{ schedule.patient.last_name }}
                                        </div>
                                    </td>
                                    <td>
                                        <span class="procedure-badge procedure-{{ schedule.procedure_type }}">
                                            {{ schedule.get_procedure_type_display }}
                                        </span>
                                    </td>
                                    <td>
                                        <div class="datetime-info">
                                            <span class="date-text">{{ study.upload_time|date:"M d, Y" }}</span>
                                            <span class="time-text">{{ study.upload_time|date:"g:i A" }}</span>
                                        </div>
                                    </td>
                                    <td style="text-align: center;">
                                        <a href="{% url 'dicom_viewer' study.id %}" class="view-btn">
                                            <span>üî¨</span>
                                            <span>View DICOM</span>
                                        </a>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endwith %}
                    {% empty %}
                        <tr>
                            <td colspan="4" class="empty-state">
                                <div class="empty-state-icon">üìÅ</div>
                                <div>No uploaded studies with DICOM files found</div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}